<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Quizy - The Quiz Game</title>
	</head>
	<body>
		<h1 id="question"></h1>
		<form name="quiz">
			<div>
				<input type="radio" name="choice" id="a1" value="0"><span id="choice0"></span>
			</div>
			<div>
				<input type="radio" name="choice" id="a2" value="1"><span id="choice1"></span>
			</div>
			<div>
				<input type="radio" name="choice" id="a3" value="2"><span id="choice2"></span>
			</div>
			<div>
				<input type="radio" name="choice" id="a4" value="3"><span id="choice3"></span>
			</div>
			<br>
			<input type="button" name="prev" value="Previous Question">
			<input type="button" name="next" value="Next Question">
			<br>
			<input type="button" name="fin" value="Finished, See Score">
		</form>
		<script>
			var answers = [];
			var currentQuestion = 0;
			
			//initial load
			var request = new XMLHttpRequest();
			request.open("GET", "quizappdata.json", false);
			request.send(null);
			request = JSON.parse(request.responseText);
			var qArr = request[currentQuestion].answers;
			var qQue = request[currentQuestion].question;
			var ansSpans = document.querySelectorAll("span");
			document.getElementById("question").innerHTML = qQue;
			for (var i = 0; i < ansSpans.length; i ++) {
				ansSpans[i].innerHTML = qArr[i];
			}
			
			function getChecked() {
				var choices = document.quiz.choice;
				for (var i = 0; i < choices.length; i++) {
					if (choices[i].checked) {
						return choices[i].value;
					}
				}
				return undefined;
			}
			
			function nextHandler() {
				//check if choice selected
				var selectedChoice = getChecked();
				if ( isNaN(selectedChoice) ) {
					return;
				}
				
				
				//============================================================================
				//choice selected, not last question ==> record answer, load next que. & ans.
				//============================================================================
				
				//record answer
				answers[currentQuestion] = selectedChoice;
				
				//load quiz data
				currentQuestion++;
				console.log(currentQuestion);
				console.log(answers);
				var request = new XMLHttpRequest();
				request.open("GET", "quizappdata.json", false);
				request.send(null);
				request = JSON.parse(request.responseText);
				var qArr = request[currentQuestion].answers;
				var qQue = request[currentQuestion].question;
				//check if last question
				if (currentQuestion == request.length - 1)
				{
					currentQuestion -= 1;
					return;
				}
				var ansSpans = document.querySelectorAll("span");
				
				document.getElementById("question").innerHTML = qQue;
				for (var i = 0; i < ansSpans.length; i ++) {
					ansSpans[i].innerHTML = qArr[i];
				}
			}
			//nextHandler();
			document.quiz.next.addEventListener("click", nextHandler);
		</script>
	</body>
</html>